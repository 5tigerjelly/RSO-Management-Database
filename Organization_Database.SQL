USE Master
GO
CREATE DATABASE [group_4]
GO
USE [group_4]
GO

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ACTIVITY]') AND type in (N'U'))
    DROP TABLE [dbo].[ACTIVITY]
GO
CREATE TABLE [dbo].[ACTIVITY] (
[ActivityID] INTEGER IDENTITY(1,1) NOT NULL  
, [ActivityTypeID] INTEGER  NOT NULL  
, [ActivityName] VARCHAR(150)  NOT NULL  
, [ActivityCost] INTEGER  NULL  
, [ActivityDesc] VARCHAR(250)  NULL  
)
GO

ALTER TABLE [dbo].[ACTIVITY] ADD CONSTRAINT [ACTIVITY_PK] PRIMARY KEY CLUSTERED (
[ActivityID]
)
GO
GO

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SUBGROUP_PERSON_ROLE]') AND type in (N'U'))
    DROP TABLE [dbo].[SUBGROUP_PERSON_ROLE]
GO
CREATE TABLE [dbo].[SUBGROUP_PERSON_ROLE] (
[Subgroup_Person_RoleID] INTEGER IDENTITY(1,1) NOT NULL  
, [GroupPersonID] INTEGER  NOT NULL  
, [RoleID] INTEGER  NOT NULL  
, [BeginDate] DATETIME  NOT NULL  
, [EndDate] DATETIME  NULL  
)
GO

ALTER TABLE [dbo].[SUBGROUP_PERSON_ROLE] ADD CONSTRAINT [SUBGROUP_PERSON_ROLE_PK] PRIMARY KEY CLUSTERED (
[Subgroup_Person_RoleID]
)
GO
GO

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ACTIVITY_OCCURENCE]') AND type in (N'U'))
    DROP TABLE [dbo].[ACTIVITY_OCCURENCE]
GO
CREATE TABLE [dbo].[ACTIVITY_OCCURENCE] (
[ActivityOccurenceID] INTEGER IDENTITY(1,1) NOT NULL  
, [ActivityID] INTEGER  NOT NULL  
, [OccurenceCost] NUMERIC(10,2)  NULL  
, [OccurenceDate] VARCHAR(50)  NULL  
, [OccurenceCompletionDate] DATETIME  NULL  
)
GO

ALTER TABLE [dbo].[ACTIVITY_OCCURENCE] ADD CONSTRAINT [ACTIVITY_OCCURENCE_PK] PRIMARY KEY CLUSTERED (
[ActivityOccurenceID]
)
GO
GO

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[MATERIAL]') AND type in (N'U'))
    DROP TABLE [dbo].[MATERIAL]
GO
CREATE TABLE [dbo].[MATERIAL] (
[MaterialID] INTEGER IDENTITY(1,1) NOT NULL  
, [MaterialName] VARCHAR(50)  NOT NULL  
, [MaterialDesc] VARCHAR(250)  NULL  
)
GO

ALTER TABLE [dbo].[MATERIAL] ADD CONSTRAINT [MATERIAL_PK] PRIMARY KEY CLUSTERED (
[MaterialID]
)
GO
GO

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[PERSON]') AND type in (N'U'))
    DROP TABLE [dbo].[PERSON]
GO
CREATE TABLE [dbo].[PERSON] (
[PersonID] INTEGER IDENTITY(1,1) NOT NULL  
, [PersonFName] VARCHAR(50)  NOT NULL  
, [PersonLName] VARCHAR(50)  NOT NULL  
, [EmailAddress] VARCHAR(75)  NULL  
, [AddressID] INTEGER  NULL  
, [PhoneID] INTEGER  NULL  
)
GO

ALTER TABLE [dbo].[PERSON] ADD CONSTRAINT [PERSON_PK] PRIMARY KEY CLUSTERED (
[PersonID]
)
GO
GO

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ROLE]') AND type in (N'U'))
    DROP TABLE [dbo].[ROLE]
GO
CREATE TABLE [dbo].[ROLE] (
[RoleID] INTEGER IDENTITY(1,1) NOT NULL  
, [RoleName] VARCHAR(50)  NOT NULL  
, [RoleDesc] VARCHAR(250)  NULL  
)
GO

ALTER TABLE [dbo].[ROLE] ADD CONSTRAINT [ROLE_PK] PRIMARY KEY CLUSTERED (
[RoleID]
)
GO
GO

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[GROUP]') AND type in (N'U'))
    DROP TABLE [dbo].[GROUP]
GO
CREATE TABLE [dbo].[GROUP] (
[GroupID] INTEGER IDENTITY(1,1) NOT NULL  
, [GroupName] VARCHAR(50)  NOT NULL  
, [GroupDesc] VARCHAR(250)  NULL  
)
GO

ALTER TABLE [dbo].[GROUP] ADD CONSTRAINT [GROUP_PK] PRIMARY KEY CLUSTERED (
[GroupID]
)
GO
GO

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[LOCATION]') AND type in (N'U'))
    DROP TABLE [dbo].[LOCATION]
GO
CREATE TABLE [dbo].[LOCATION] (
[LocationID] INTEGER IDENTITY(1,1) NOT NULL  
, [LocationName] VARCHAR(50)  NOT NULL  
, [AddressID] INTEGER  NOT NULL  
)
GO

ALTER TABLE [dbo].[LOCATION] ADD CONSTRAINT [LOCATION_PK] PRIMARY KEY CLUSTERED (
[LocationID]
)
GO
GO

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ADDRESS]') AND type in (N'U'))
    DROP TABLE [dbo].[ADDRESS]
GO
CREATE TABLE [dbo].[ADDRESS] (
[AddressID] INTEGER IDENTITY(1,1) NOT NULL  
, [Street] VARCHAR(50)  NOT NULL  
, [ZipCode] CHAR(5)  NOT NULL  
)
GO

ALTER TABLE [dbo].[ADDRESS] ADD CONSTRAINT [ADDRESS_PK] PRIMARY KEY CLUSTERED (
[AddressID]
)
GO
GO

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ACTIVITY_TYPE]') AND type in (N'U'))
    DROP TABLE [dbo].[ACTIVITY_TYPE]
GO
CREATE TABLE [dbo].[ACTIVITY_TYPE] (
[ActivityTypeID] INTEGER IDENTITY(1,1) NOT NULL  
, [ActivityTypeName] VARCHAR(50)  NOT NULL  
, [ActivityTypeDescription] VARCHAR(250)  NULL  
)
GO

ALTER TABLE [dbo].[ACTIVITY_TYPE] ADD CONSTRAINT [ACTIVITY_TYPE_PK] PRIMARY KEY CLUSTERED (
[ActivityTypeID]
)
GO
GO

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ACTIVITY_LOCATION]') AND type in (N'U'))
    DROP TABLE [dbo].[ACTIVITY_LOCATION]
GO
CREATE TABLE [dbo].[ACTIVITY_LOCATION] (
[ActivityLocationID] INTEGER IDENTITY(1,1) NOT NULL  
, [ActivityID] INTEGER  NOT NULL  
, [LocationID] INTEGER  NOT NULL  
)
GO

ALTER TABLE [dbo].[ACTIVITY_LOCATION] ADD CONSTRAINT [ACTIVITY_LOCATION_PK] PRIMARY KEY CLUSTERED (
[ActivityLocationID]
)
GO
GO

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[PHONE]') AND type in (N'U'))
    DROP TABLE [dbo].[PHONE]
GO
CREATE TABLE [dbo].[PHONE] (
[PhoneID] INTEGER IDENTITY(1,1) NOT NULL  
, [AreaCode] CHAR(3)  NOT NULL  
, [PhoneNumber] CHAR(7)  NOT NULL  
)
GO

ALTER TABLE [dbo].[PHONE] ADD CONSTRAINT [PHONE_PK] PRIMARY KEY CLUSTERED (
[PhoneID]
)
GO
GO

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[PERSON_ACTIVITY]') AND type in (N'U'))
    DROP TABLE [dbo].[PERSON_ACTIVITY]
GO
CREATE TABLE [dbo].[PERSON_ACTIVITY] (
[PersonOccurenceID] INTEGER IDENTITY(1,1) NOT NULL  
, [PersonID] INTEGER  NOT NULL  
, [ActivityOccurenceID] INTEGER  NOT NULL  
)
GO

ALTER TABLE [dbo].[PERSON_ACTIVITY] ADD CONSTRAINT [PERSON_ACTIVITY_PK] PRIMARY KEY CLUSTERED (
[PersonOccurenceID]
)
GO
GO

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SUB_GROUP]') AND type in (N'U'))
    DROP TABLE [dbo].[SUB_GROUP]
GO
CREATE TABLE [dbo].[SUB_GROUP] (
[SubGroupID] INTEGER IDENTITY(1,1) NOT NULL  
, [GroupID] INTEGER  NOT NULL  
, [SubGroupName] VARCHAR(50)  NULL  
, [SubGroupDescription] VARCHAR(150)  NULL  
)
GO

ALTER TABLE [dbo].[SUB_GROUP] ADD CONSTRAINT [SUB_GROUP_PK] PRIMARY KEY CLUSTERED (
[SubGroupID]
)
GO
GO

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SUBGROUP_PERSON]') AND type in (N'U'))
    DROP TABLE [dbo].[SUBGROUP_PERSON]
GO
CREATE TABLE [dbo].[SUBGROUP_PERSON] (
[GroupPersonID] INTEGER IDENTITY(1,1) NOT NULL  
, [SubGroupID] INTEGER  NOT NULL  
, [PersonID] INTEGER  NOT NULL  
, [BeginDate] DATETIME  NOT NULL  
, [EndDate] DATETIME  NULL  
)
GO

ALTER TABLE [dbo].[SUBGROUP_PERSON] ADD CONSTRAINT [SUBGROUP_PERSON_PK] PRIMARY KEY CLUSTERED (
[GroupPersonID]
)
GO
GO

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ACTIVITY_MATERIAL]') AND type in (N'U'))
    DROP TABLE [dbo].[ACTIVITY_MATERIAL]
GO
CREATE TABLE [dbo].[ACTIVITY_MATERIAL] (
[ActivityMaterialID] INTEGER IDENTITY(1,1) NOT NULL  
, [ActivityID] INTEGER  NULL  
, [MaterialID] INTEGER  NULL  
)
GO

ALTER TABLE [dbo].[ACTIVITY_MATERIAL] ADD CONSTRAINT [ACTIVITY_MATERIAL_PK] PRIMARY KEY CLUSTERED (
[ActivityMaterialID]
)
GO
GO

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[PERSON_PERSON_TYPE]') AND type in (N'U'))
    DROP TABLE [dbo].[PERSON_PERSON_TYPE]
GO
CREATE TABLE [dbo].[PERSON_PERSON_TYPE] (
[PersonPersonType] INTEGER IDENTITY(1,1) NOT NULL  
, [PersonID] INTEGER  NOT NULL  
, [PersonTypeID] INTEGER  NOT NULL  
, [BeginDate] DATETIME  NOT NULL  
, [EndDate] DATETIME  NULL  
)
GO

ALTER TABLE [dbo].[ACTIVITY] WITH CHECK ADD CONSTRAINT [ACTIVITY_TYPE_ACTIVITY_FK1] FOREIGN KEY (
[ActivityTypeID]
)
REFERENCES [dbo].[ACTIVITY_TYPE] (
[ActivityTypeID]
)
GO

ALTER TABLE [dbo].[SUBGROUP_PERSON_ROLE] WITH CHECK ADD CONSTRAINT [SUBGROUP_PERSON_SUBGROUP_PERSON_ROLE_FK1] FOREIGN KEY (
[GroupPersonID]
)
REFERENCES [dbo].[SUBGROUP_PERSON] (
[GroupPersonID]
)
ALTER TABLE [dbo].[SUBGROUP_PERSON_ROLE] WITH CHECK ADD CONSTRAINT [ROLE_SUBGROUP_PERSON_ROLE_FK1] FOREIGN KEY (
[RoleID]
)
REFERENCES [dbo].[ROLE] (
[RoleID]
)
GO

ALTER TABLE [dbo].[ACTIVITY_OCCURENCE] WITH CHECK ADD CONSTRAINT [ACTIVITY_ACTIVITY_OCCURENCE_FK1] FOREIGN KEY (
[ActivityID]
)
REFERENCES [dbo].[ACTIVITY] (
[ActivityID]
)
GO

GO

ALTER TABLE [dbo].[PERSON] WITH CHECK ADD CONSTRAINT [ADDRESS_PERSON_FK1] FOREIGN KEY (
[AddressID]
)
REFERENCES [dbo].[ADDRESS] (
[AddressID]
)
ALTER TABLE [dbo].[PERSON] WITH CHECK ADD CONSTRAINT [PHONE_PERSON_FK1] FOREIGN KEY (
[PhoneID]
)
REFERENCES [dbo].[PHONE] (
[PhoneID]
)
GO

GO

GO

ALTER TABLE [dbo].[LOCATION] WITH CHECK ADD CONSTRAINT [ADDRESS_LOCATION_FK1] FOREIGN KEY (
[AddressID]
)
REFERENCES [dbo].[ADDRESS] (
[AddressID]
)
GO

GO

GO

ALTER TABLE [dbo].[ACTIVITY_LOCATION] WITH CHECK ADD CONSTRAINT [LOCATION_ACTIVITY_LOCATION_FK1] FOREIGN KEY (
[LocationID]
)
REFERENCES [dbo].[LOCATION] (
[LocationID]
)
ALTER TABLE [dbo].[ACTIVITY_LOCATION] WITH CHECK ADD CONSTRAINT [ACTIVITY_ACTIVITY_LOCATION_FK1] FOREIGN KEY (
[ActivityID]
)
REFERENCES [dbo].[ACTIVITY] (
[ActivityID]
)
GO

GO

ALTER TABLE [dbo].[PERSON_ACTIVITY] WITH CHECK ADD CONSTRAINT [ACTIVITY_OCCURENCE_PERSON_ACTIVITY_FK1] FOREIGN KEY (
[ActivityOccurenceID]
)
REFERENCES [dbo].[ACTIVITY_OCCURENCE] (
[ActivityOccurenceID]
)
ALTER TABLE [dbo].[PERSON_ACTIVITY] WITH CHECK ADD CONSTRAINT [PERSON_PERSON_ACTIVITY_FK1] FOREIGN KEY (
[PersonID]
)
REFERENCES [dbo].[PERSON] (
[PersonID]
)
GO

GO

ALTER TABLE [dbo].[SUB_GROUP] WITH CHECK ADD CONSTRAINT [GROUP_SUB_GROUP_FK1] FOREIGN KEY (
[GroupID]
)
REFERENCES [dbo].[GROUP] (
[GroupID]
)
GO

ALTER TABLE [dbo].[SUBGROUP_PERSON] WITH CHECK ADD CONSTRAINT [PERSON_SUBGROUP_PERSON_FK1] FOREIGN KEY (
[PersonID]
)
REFERENCES [dbo].[PERSON] (
[PersonID]
)
ALTER TABLE [dbo].[SUBGROUP_PERSON] WITH CHECK ADD CONSTRAINT [SUB_GROUP_SUBGROUP_PERSON_FK1] FOREIGN KEY (
[SubGroupID]
)
REFERENCES [dbo].[SUB_GROUP] (
[SubGroupID]
)
GO

ALTER TABLE [dbo].[ACTIVITY_MATERIAL] WITH CHECK ADD CONSTRAINT [MATERIAL_ACTIVITY_MATERIAL_FK1] FOREIGN KEY (
[MaterialID]
)
REFERENCES [dbo].[MATERIAL] (
[MaterialID]
)
ALTER TABLE [dbo].[ACTIVITY_MATERIAL] WITH CHECK ADD CONSTRAINT [ACTIVITY_ACTIVITY_MATERIAL_FK1] FOREIGN KEY (
[ActivityID]
)
REFERENCES [dbo].[ACTIVITY] (
[ActivityID]
)
GO